# SN码功能测试指南

## 🎯 测试目标

验证SN码（一物一码）功能的完整性：
1. ✅ SN码唯一性验证
2. ✅ 打印PDF中显示SN码

## 📝 测试步骤

### 测试1：SN码唯一性验证

#### 步骤：
1. 刷新浏览器（`Ctrl + Shift + R`）
2. 进入"入库单管理"或"出库单管理"
3. 新建一个订单
4. 在商品明细中，点击"录入SN码"按钮
5. 输入SN码：`TEST001`，点击添加
6. ✅ **验证点1**：应提示"已添加SN码: TEST001（已通过验证）"
7. 再次尝试输入相同的SN码：`TEST001`
8. ✅ **验证点2**：应提示"SN码已存在，请勿重复录入"

### 测试2：入库单打印显示SN码

#### 准备数据：
1. 创建一个新的入库单
2. 添加商品，数量设为 2
3. 点击"录入SN码"，输入：`SN001` 和 `SN002`
4. 完成入库

#### 测试打印：
1. 在入库单列表中，找到刚才的入库单
2. 点击"打印"按钮
3. ✅ **验证点**：打印预览中应该有"SN码"列
4. ✅ **验证点**：SN码列显示内容为："SN001, SN002"

**预期效果：**
```
┌────────────────────────────────────────────────────┐
│ 商品名称 │ 规格 │ 数量 │ SN码         │ 价格    │
├────────────────────────────────────────────────────┤
│ 测试商品 │ 默认 │  2   │ SN001, SN002 │ 100.00  │
└────────────────────────────────────────────────────┘
```

### 测试3：出库单打印显示SN码

#### 准备数据：
1. 创建一个新的出库单
2. 选择库存商品（有SN码的）
3. 完成出库

#### 测试打印：
1. 点击"打印"按钮
2. ✅ **验证点**：打印预览中应该有"SN码"列
3. ✅ **验证点**：显示对应的SN码

### 测试4：无SN码的商品打印

#### 准备数据：
1. 创建一个入库单/出库单
2. 添加商品，但**不录入SN码**
3. 完成入库/出库

#### 测试打印：
1. 点击"打印"按钮
2. ✅ **验证点**：SN码列显示"无"

**预期效果：**
```
┌────────────────────────────────────────────────┐
│ 商品名称 │ 规格 │ 数量 │ SN码 │ 价格        │
├────────────────────────────────────────────────┤
│ 普通商品 │ 默认 │  10  │ 无   │ 50.00       │
└────────────────────────────────────────────────┘
```

### 测试5：移库单打印

1. 创建一个移库单
2. 完成移库
3. 点击"打印"
4. ✅ **验证点**：打印预览中有"SN码"列

### 测试6：盘点单打印

1. 创建一个盘点单
2. 完成盘点
3. 点击"打印"
4. ✅ **验证点**：打印预览中有"SN码"列（在账面库存之后）

## 🔍 验证清单

### SN码唯一性验证
- [ ] 首次输入SN码成功
- [ ] 重复输入SN码时提示"已存在"
- [ ] 本地（页面内）重复验证
- [ ] 服务器端（数据库）重复验证

### 打印功能验证
- [ ] 入库单打印显示SN码列
- [ ] 出库单打印显示SN码列
- [ ] 移库单打印显示SN码列
- [ ] 盘点单打印显示SN码列
- [ ] 有SN码时正确显示（逗号分隔）
- [ ] 无SN码时显示"无"

## 🐛 可能遇到的问题

### 问题1：看不到SN码列

**原因：** 浏览器缓存未清除

**解决：**
1. 按 `Ctrl + Shift + R` 硬刷新
2. 或清除浏览器缓存后重新加载

### 问题2：SN码显示为空白

**原因：** 数据库中该订单明细没有SN码数据

**解决：**
1. 检查是否录入了SN码
2. 重新录入SN码后再打印

### 问题3：SN码验证接口404

**原因：** 后端接口未启动或路径错误

**解决：**
1. 确认后端服务正常运行
2. 检查接口路径：`POST /wms/sn/input`

## 📊 打印效果对比

### ✅ 正确效果

```
打印预览中应显示完整的SN码列：

商品名称 | 规格 | 数量 | SN码           | 价格
---------|------|------|----------------|------
手机     | 128G |  3   | SN001,SN002,SN003 | 2999
电脑     | i7   |  1   | SN004          | 5999
鼠标     | 无线 |  5   | 无             | 99
```

### ❌ 错误效果

```
如果看到以下情况，说明有问题：

1. 缺少SN码列：
商品名称 | 规格 | 数量 | 价格
---------|------|------|------

2. SN码显示为undefined或null：
商品名称 | 规格 | 数量 | SN码   | 价格
---------|------|------|--------|------
手机     | 128G |  3   | undefined | 2999
```

## 📞 测试反馈

如果发现任何问题，请记录：

1. **问题描述**：简要说明问题
2. **重现步骤**：如何触发该问题
3. **预期结果**：应该看到什么
4. **实际结果**：实际看到什么
5. **截图**：如果可能，提供截图

## ✅ 测试完成确认

测试完成后，请确认以下所有功能正常：

- [x] SN码录入功能正常
- [x] SN码唯一性验证正常
- [x] 入库单打印显示SN码
- [x] 出库单打印显示SN码
- [x] 移库单打印显示SN码
- [x] 盘点单打印显示SN码
- [x] 无SN码时显示"无"

## 🎉 全部测试通过

如果上述所有测试都通过，恭喜！SN码功能已经完全正常工作了！

---

**测试日期：** ____________

**测试人员：** ____________

**测试结果：** ☐ 通过 ☐ 未通过

**备注：** ______________________________

