# 一物一码/SN管理功能使用说明

## 功能概述

一物一码/SN（Serial Number）管理功能用于管理仓库中物品的唯一序列号，支持手动输入和扫描枪扫描两种录入方式。

## 功能特性

### 1. **SN码录入**
   - **手动输入**：点击"手动输入SN码"按钮，可以手动输入SN码并绑定物品信息
   - **扫描录入**：点击"扫描录入"按钮，弹出扫描界面，可使用扫描枪进行批量扫描录入

### 2. **SN码管理**
   - 查询：支持按SN码、物品名称、绑定状态等条件查询
   - 修改：支持修改SN码的绑定信息和其他属性
   - 删除：支持单个或批量删除SN码记录
   - 导出：支持导出SN码列表到Excel

### 3. **绑定管理**
   - 绑定物品：将SN码与物品信息关联
   - 解绑：解除SN码与物品的关联关系
   - 状态跟踪：跟踪SN码的绑定状态（未绑定/已绑定）

## 使用流程

### 一、初始化数据库

1. 执行SQL脚本创建数据表和初始化数据：
```bash
mysql -u用户名 -p数据库名 < backend/script/sql/wms_serial_number.sql
```

### 二、访问功能页面

1. 登录系统后，在菜单中找到"一物一码/SN管理"
2. 或直接访问：`/wms/sn`

### 三、手动录入SN码

1. 点击"手动输入SN码"按钮
2. 填写SN码（必填）
3. 选择要绑定的物品（可选）
4. 填写备注信息（可选）
5. 点击"确定"保存

### 四、扫描录入SN码

1. 点击"扫描录入"按钮
2. 连接扫描枪设备到计算机
3. 确保输入焦点在扫描输入框中
4. 使用扫描枪扫描物品上的SN码
5. 扫描枪会自动输入SN码并按回车确认
6. 已扫描的SN码会显示在"已扫描列表"中
7. 可以继续扫描多个SN码
8. 点击"确认提交"批量保存所有扫描的SN码

### 五、查询和管理

1. **条件查询**
   - 在查询表单中输入查询条件
   - 点击"搜索"按钮查询
   - 点击"重置"按钮清空条件

2. **修改SN码**
   - 在列表中点击某条记录的"修改"按钮
   - 在弹出的对话框中修改信息
   - 点击"确定"保存

3. **删除SN码**
   - 单个删除：点击记录的"删除"按钮
   - 批量删除：勾选多条记录，点击工具栏的"删除"按钮

4. **导出数据**
   - 设置查询条件（可选）
   - 点击导出按钮，下载Excel文件

## API接口说明

### 前端API（/api/wms/sn.js）

- `listSn(query)`：查询SN码列表
- `getSn(snCode)`：查询SN码详情
- `addSn(data)`：新增SN码（手动输入）
- `updateSn(data)`：修改SN码
- `delSn(snCodes)`：删除SN码
- `scanSn()`：扫描录入（返回提示信息）
- `validateSnBatch(snCodes)`：批量验证SN码
- `bindSnToItem(data)`：绑定SN码到物品
- `unbindSn(snCode)`：解绑SN码

### 后端API

#### 1. 查询列表
```
GET /wms/sn/list
参数：pageNum, pageSize, snCode, itemName, bindStatus
```

#### 2. 查询详情
```
GET /wms/sn/{snCode}
```

#### 3. 新增SN码
```
POST /wms/sn
Body: { snCode, itemId, itemNo, itemName, spec, bindStatus, remark }
```

#### 4. 修改SN码
```
PUT /wms/sn
Body: { snId, snCode, itemId, itemNo, itemName, spec, bindStatus, remark }
```

#### 5. 删除SN码
```
DELETE /wms/sn/{snCodes}
```

#### 6. 扫描录入（预留接口）
```
POST /wms/sn/scan
返回：提示信息"请连接扫描枪设备"
```

#### 7. 批量验证
```
POST /wms/sn/validate/batch
Body: ["SN001", "SN002", ...]
```

#### 8. 绑定物品
```
POST /wms/sn/bind
Body: { snId, itemId, itemNo, itemName, spec }
```

#### 9. 解绑
```
POST /wms/sn/unbind/{snCode}
```

## 数据字典

### 绑定状态（bind_status）

| 值 | 标签 | 样式 |
|----|------|------|
| 0 | 未绑定 | info |
| 1 | 已绑定 | success |

## 技术实现说明

### 前端技术栈
- Vue 3
- Element Plus
- Composition API

### 后端技术栈
- Spring Boot
- MyBatis Plus
- RuoYi框架

### 扫描枪集成说明

当前版本中，扫描枪接口为预留接口，点击"扫描录入"按钮会提示"请连接扫描枪"。

**实际集成扫描枪时需要：**

1. **硬件准备**：
   - USB扫描枪或蓝牙扫描枪
   - 确保扫描枪驱动已安装

2. **前端集成**：
   - 扫描枪通常模拟键盘输入
   - 在扫描输入框获得焦点后，扫描枪会自动输入内容
   - 监听`keyup.enter`事件处理扫描结果

3. **后端集成**：
   - 如果需要与硬件设备通信，需要实现相应的驱动接口
   - 可以使用WebSocket实时推送扫描结果
   - 或通过串口通信等方式直接读取扫描枪数据

## 注意事项

1. **SN码唯一性**：系统会自动检查SN码的唯一性，不允许重复录入
2. **扫描枪配置**：确保扫描枪配置为自动回车模式（扫描后自动按回车键）
3. **批量操作**：批量删除操作需要谨慎使用，删除后数据无法恢复
4. **权限控制**：需要配置相应的菜单权限才能访问此功能
5. **物品绑定**：绑定物品前需要先在物品管理中创建物品信息

## 常见问题

### Q1：扫描枪扫描没有反应？
**A**：检查以下几点：
- 扫描枪是否正常连接
- 扫描枪是否配置为键盘模式
- 扫描输入框是否获得焦点

### Q2：提示SN码已存在？
**A**：系统不允许录入重复的SN码，请检查该SN码是否已存在于系统中

### Q3：如何批量导入SN码？
**A**：可以使用扫描录入功能批量扫描，或者使用Excel导入功能（需要扩展开发）

### Q4：SN码能否修改？
**A**：为保证数据准确性，SN码本身在创建后不能修改，但可以修改绑定的物品信息

## 扩展功能建议

1. **Excel批量导入**：支持通过Excel批量导入SN码
2. **打印标签**：支持打印带有SN码的标签
3. **历史记录**：记录SN码的流转历史（入库、出库、移库等）
4. **二维码生成**：自动生成SN码对应的二维码
5. **移动端支持**：开发移动端App，方便现场扫描录入

## 版本历史

- v1.0.0 (2025-01-27)
  - 初始版本
  - 支持手动输入和扫描录入（预留接口）
  - 基础的增删改查功能
  - 物品绑定/解绑功能


